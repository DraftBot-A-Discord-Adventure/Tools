// Icon service for loading and managing Crownicles icons
class IconService {
    constructor(elements) {
        this.elements = elements;
        // Direct emoji mapping - no loading needed
        this.crowniclesIcons = {
            weapons: {
                0: "ðŸ‘Š", 1: "âš¡", 2: "ðŸ› ï¸", 3: "ðŸ", 4: "ðŸ¹", 5: "ðŸ”¨", 6: "ðŸ”ª", 7: "ðŸ—¡ï¸", 8: "ðŸ“Œ", 9: "ðŸ”§",
                10: "âš”ï¸", 11: "ðŸ”«", 12: "ðŸ’‰", 13: "ðŸ’£", 14: "ðŸŽ¸", 15: "âš”ï¸", 16: "â›ï¸", 17: "ðŸ”§", 18: "ðŸªµ", 19: "ðŸ”ª",
                20: "ðŸŒ¿", 21: "â›ï¸", 22: "ðŸ¹", 23: "ðŸ³", 24: "âœ‚ï¸", 25: "ðŸ—¡ï¸", 26: "ðŸ‘", 27: "ðŸ—¡ï¸", 28: "ðŸ”¨", 29: "ðŸ”ª",
                30: "ðŸ¥Š", 31: "ðŸ¤œ", 32: "ðŸŽ£", 33: "ðŸ”ª", 34: "ðŸŽ£", 35: "ðŸŽ£", 36: "âš”ï¸", 37: "âš”ï¸", 38: "âš”ï¸", 39: "âš”ï¸",
                40: "âš”ï¸", 41: "âš”ï¸", 42: "ðŸ”«", 43: "ðŸ¥’", 44: "ðŸ’", 45: "ðŸŒ", 46: "ðŸ”–", 47: "â„ï¸", 48: "ðŸ¹", 49: "ðŸ¹",
                50: "ðŸ¹", 51: "ðŸ¹", 52: "ðŸª’", 53: "ðŸª‘", 54: "ðŸ§±", 55: "ðŸ´", 56: "ðŸ—¡ï¸", 57: "ðŸ§¯", 58: "ðŸ”–", 59: "ðŸ’‰",
                60: "ðŸ’‰", 61: "ðŸ’‰", 62: "ðŸ¦ ", 63: "ðŸ’£", 64: "ðŸ•¯ï¸", 65: "ðŸ¥¢", 66: "âš”ï¸", 67: "âš”ï¸", 68: "ðŸ¤›", 69: "âš”ï¸",
                70: "ðŸ”«", 71: "âš”ï¸", 72: "âš½", 73: "ðŸª“", 74: "â˜„ï¸", 75: "ðŸªƒ", 76: "âš¡", 77: "ðŸ¤¿", 78: "ðŸ«‚", 79: "ðŸŒ‚",
                80: "ðŸŽ†", 81: "ðŸ—¡ï¸", 82: "ðŸ¦¶", 83: "ðŸ¤¬", 84: "ðŸª›", 85: "â¤ï¸", 86: "ðŸŽ­", 87: "âš ï¸", 88: "ðŸª¶", 89: "ðŸ‰",
                90: "ðŸ¦„", 91: "ðŸ­", 92: "ðŸŽ®", 93: "ðŸ´", 94: "ðŸ’€", 95: "ðŸ—¯ï¸", 96: "âš›ï¸", 97: "ðŸ¦â€ðŸ”¥", 98: "â„ï¸"
            },
            armors: {
                0: "â¬›", 1: "ðŸ‘ï¸", 2: "â›‘ï¸", 3: "ðŸ›¡ï¸", 4: "ðŸ›¡ï¸", 5: "ðŸ›¡ï¸", 6: "ðŸ¤º", 7: "ðŸ‘˜", 8: "ðŸ›¡ï¸", 9: "ðŸ›¡ï¸",
                10: "ðŸ›¡ï¸", 11: "ðŸ›¡ï¸", 12: "ðŸ›¡ï¸", 13: "ðŸ›¡ï¸", 14: "ðŸ›¡ï¸", 15: "ðŸ›¡ï¸", 16: "ðŸ›¡ï¸", 17: "ðŸ”†", 18: "ðŸ¥‹", 19: "ðŸ¦º",
                20: "ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦", 21: "ðŸ¦¾", 22: "ðŸ¤–", 23: "ðŸŒ‚", 24: "ðŸ›¡ï¸", 25: "ðŸ›¡ï¸", 26: "ðŸ‰", 27: "âœ¨", 28: "ðŸ›¡ï¸", 29: "ðŸ›¡ï¸",
                30: "ðŸ›¡ï¸", 31: "ðŸ›¡ï¸", 32: "ðŸ›¡ï¸", 33: "ðŸ›¡ï¸", 34: "ðŸ›¡ï¸", 35: "ðŸ›¡ï¸", 36: "ðŸ›¡ï¸", 37: "ðŸ›¡ï¸", 38: "ðŸ›¡ï¸", 39: "ðŸª–",
                40: "ðŸ¢", 41: "ðŸª™", 42: "ðŸª–", 43: "ðŸª£", 44: "ðŸ§±", 45: "â™Ÿï¸", 46: "ðŸªŸ", 47: "ðŸ¯", 48: "ðŸ§¥", 49: "ðŸ§¥",
                50: "ðŸ¥¼", 51: "â›º", 52: "ðŸ›¡ï¸", 53: "ðŸ›¡ï¸", 54: "ðŸ—¿", 55: "ðŸ¤¡", 56: "ðŸ¥±", 57: "ðŸª¶", 58: "ðŸ§ž", 59: "ðŸ§™",
                60: "ðŸ§”ðŸ»", 61: "âœ¨", 62: "ðŸ›¡ï¸", 63: "ðŸƒ", 64: "ðŸ›¡ï¸"
            },
            objects: {
                0: "â¬›", 1: "ðŸ³ï¸", 2: "ðŸŽ²", 3: "ðŸ’Ž", 4: "ðŸµï¸", 5: "ðŸŒ", 6: "ðŸ”®", 7: "â›“ï¸", 8: "ðŸ€", 9: "ðŸ—ï¸",
                10: "ðŸ‘ž", 11: "ðŸ‘¼ðŸ½", 12: "ðŸŒ‘", 13: "ðŸ‚", 14: "ðŸŽ", 15: "ðŸ", 16: "ðŸ’—", 17: "ðŸ“•", 18: "ðŸ“˜", 19: "ðŸ“™",
                20: "ðŸ“—", 21: "ðŸ“¿", 22: "ðŸ´", 23: "âšœï¸", 24: "ðŸ›¢ï¸", 25: "ðŸ•¯ï¸", 26: "ðŸº", 27: "ðŸŽ·", 28: "ðŸŽ¸", 29: "ðŸ’³",
                30: "ðŸ¦¿", 31: "ðŸ˜¹", 32: "ðŸ¥„", 33: "ðŸŽƒ", 34: "ðŸ§¸", 35: "ðŸ§²", 36: "ðŸ©¹", 37: "â›·ï¸", 38: "ðŸŒ€", 39: "ðŸ’ ",
                40: "ðŸ‘¼", 41: "ðŸº", 42: "ðŸ•", 43: "ðŸŒ", 44: "ðŸŽ", 45: "ðŸŸ§", 46: "ðŸŒŸ", 47: "ðŸ“–", 48: "ðŸŽ¥", 49: "ðŸ§´",
                50: "ðŸ¥¾", 51: "ðŸ§¹", 52: "ðŸ§¼", 53: "ðŸŽ–ï¸", 54: "ðŸ“¯", 55: "ðŸ’°", 56: "ðŸŽ°", 57: "ðŸ‘ ", 58: "ðŸª", 59: "ðŸ«",
                60: "ðŸ¢", 61: "ðŸ•µï¸", 62: "ðŸ‘ï¸", 63: "â›ï¸", 64: "ðŸ§±", 65: "ðŸŽ¶", 66: "ðŸŒ", 67: "ðŸš—", 68: "ðŸŸ¦", 69: "ðŸŽ§",
                70: "ðŸ›ï¸", 71: "ðŸ¤–", 72: "â˜€ï¸", 73: "ðŸŽ¢", 74: "ðŸŒ¶ï¸", 75: "ðŸ”Œ", 76: "ðŸ–", 77: "ðŸ§‘â€âš•ï¸", 78: "â¤ï¸â€ðŸ©¹", 79: "ðŸ§¬",
                80: "ðŸ”‹", 81: "ðŸ”‹", 82: "ðŸª³", 83: "ðŸš€", 84: "ðŸ€", 85: "ðŸ§»", 86: "ðŸŒŸ", 87: "ðŸŽ¸", 88: "ðŸ’¾", 89: "ðŸŸ",
                90: "ðŸ¸", 91: "ðŸ›°ï¸", 92: "ðŸªˆ"
            },
            potions: {
                0: "â¬›", 1: "ðŸ·", 2: "ðŸ·", 3: "ðŸ·", 4: "ðŸ·", 5: "ðŸ·", 6: "ðŸ§ª", 7: "ðŸ§ª", 8: "ðŸ§ª", 9: "ðŸ§ª",
                10: "ðŸ‡", 11: "ðŸ‡", 12: "âš—ï¸", 13: "âš—ï¸", 14: "âš—ï¸", 15: "âš—ï¸", 16: "ðŸ§ƒ", 17: "ðŸ§ƒ", 18: "ðŸ¸", 19: "ðŸ¸",
                20: "ðŸ¸", 21: "ðŸ¸", 22: "â¤ï¸", 23: "â¤ï¸", 24: "â¤ï¸", 25: "ðŸ¹", 26: "ðŸ¥›", 27: "ðŸ¼", 28: "ðŸµ", 29: "â˜•",
                30: "ðŸ¥ƒ", 31: "ðŸ¥˜", 32: "ðŸ’§", 33: "ðŸ·", 34: "ðŸ£", 35: "â›½", 36: "ðŸµ", 37: "ðŸ¥¤", 38: "ðŸ¶", 39: "ðŸ§‰",
                40: "ðŸ¾", 41: "ðŸ§ª", 42: "â¤ï¸", 43: "ðŸ¥¤", 44: "ðŸº", 45: "ðŸŒ±", 46: "ðŸŒ¶", 47: "â˜ ", 48: "ðŸ”‹", 49: "ðŸ¥œ",
                50: "ðŸº", 51: "ðŸ¥«", 52: "ðŸ¥«", 53: "ðŸ¥«", 54: "ðŸª…", 55: "ðŸ«•", 56: "ðŸ’©", 57: "ðŸ©¸", 58: "ðŸ§±", 59: "ðŸ«§",
                60: "ðŸ’¦", 61: "ðŸš±", 62: "ðŸŒŠ", 63: "ðŸ«™", 64: "â™»", 65: "ðŸ«—", 66: "ðŸ§‹", 67: "ðŸ§ƒ", 68: "ðŸ§ƒ", 69: "ðŸ¯",
                70: "ðŸ§…", 71: "ðŸ—»", 72: "â›ˆ", 73: "â˜•", 74: "ðŸ«—", 75: "ðŸŒµ", 76: "ðŸš¿", 77: "ðŸ›µ", 78: "ðŸ§¼", 79: "ðŸª·",
                80: "ðŸ¥¶", 81: "âœ’", 82: "ðŸ›", 83: "ðŸŒ‚", 84: "ðŸª¶", 85: "ðŸ’‰", 86: "ðŸ¸", 87: "ðŸ´â€â˜ ï¸", 88: "ðŸŒ", 89: "â™¨",
                90: "ðŸ¥”", 91: "ðŸŒŠ", 92: "ðŸ§Œ", 93: "ðŸŒ‹", 94: "ðŸ«"
            },
            rarity: ["ðŸ”¸", "ðŸ”¶", "ðŸ”¥", "ðŸ”±", "â˜„ï¸", "ðŸ’«", "â­", "ðŸŒŸ", "ðŸ’Ž"],
            itemNatures: ["âŒ", "â¤ï¸", "ðŸš€", "âš”ï¸", "ðŸ›¡ï¸", "ðŸ•¥", "ðŸ’°", "âš¡"],
            itemCategories: ["âš”ï¸", "ðŸ›¡ï¸", "âš—ï¸", "ðŸ§¸"]
        };
    }

    async loadCrowniclesIcons(branch) {
        // Simulate loading for UI consistency
        this.elements.loadingStatus.textContent = 'Loading Crownicles icons...';
        await new Promise(resolve => setTimeout(resolve, 100));
        
        console.log('Loaded Crownicles icons (embedded):', {
            weapons: Object.keys(this.crowniclesIcons.weapons).length,
            armors: Object.keys(this.crowniclesIcons.armors).length,
            objects: Object.keys(this.crowniclesIcons.objects).length,
            potions: Object.keys(this.crowniclesIcons.potions).length
        });
    }

    getItemEmoji(item) {
        const typeMap = {
            'weapon': 'weapons',
            'armor': 'armors', 
            'object': 'objects',
            'potion': 'potions'
        };
        
        const iconType = typeMap[item.type];
        
        // Try to get specific icon first
        if (iconType && this.crowniclesIcons[iconType] && this.crowniclesIcons[iconType][item.id]) {
            return this.crowniclesIcons[iconType][item.id];
        }
        
        // If no specific icon found, use category emoji
        return this.getCategoryEmoji(item.type);
    }

    getCategoryEmoji(type) {
        const categoryMap = {
            'weapon': 0,
            'armor': 1,    
            'potion': 2,
            'object': 3
        };
        
        const categoryIndex = categoryMap[type];
        
        if (this.crowniclesIcons.itemCategories && this.crowniclesIcons.itemCategories.length > categoryIndex) {
            return this.crowniclesIcons.itemCategories[categoryIndex];
        }
        
        return '';
    }

    getRarityEmoji(rarity) {
        return this.crowniclesIcons.rarity[rarity] || '';
    }

    getNatureEmoji(nature) {
        return this.crowniclesIcons.itemNatures[nature] || '';
    }
}